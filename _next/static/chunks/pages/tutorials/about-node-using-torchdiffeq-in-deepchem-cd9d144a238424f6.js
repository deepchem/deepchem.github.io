(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5621],{5235:function(s,n,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tutorials/about-node-using-torchdiffeq-in-deepchem",function(){return a(3959)}])},3959:function(s,n,a){"use strict";a.r(n),a.d(n,{default:function(){return d}});var p=a(5893),l=a(1618),e=a(6485),t={html:'<main>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h1>\n      About Neural ODE : Using\n      <code>\n       Torchdiffeq\n      </code>\n      with\n      <code>\n       Deepchem\n      </code>\n      <a class="anchor-link" href="#About-Neural-ODE-:-Using-Torchdiffeq-with-Deepchem">\n       \xb6\n      </a>\n     </h1>\n     <p>\n      Author :\n      <a href="https://github.com/shivance">\n       Anshuman Mishra\n      </a>\n      :\n      <a href="https://www.linkedin.com/in/iamanshuman/">\n       Linkedin\n      </a>\n     </p>\n     <p>\n      <a href="https://colab.research.google.com/drive/1x1_EexmiTk01dsAbdfopWKWbIGENiXC1?usp=sharing">\n       <img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/>\n      </a>\n     </p>\n     <p>\n      Before getting our hands dirty with code , let us first understand little bit about what Neural ODEs are ?\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h1>\n      NeuralODEs and torchdiffeq\n      <a class="anchor-link" href="#NeuralODEs-and-torchdiffeq">\n       \xb6\n      </a>\n     </h1>\n     <p>\n      NeuralODE stands for "Neural Ordinary Differential Equation. You heard right. Let me guess . Your first impression of the word is : "Has it something to do with differential equations that we studied in the school ?"\n     </p>\n     <p>\n      Spot on ! Let\'s see the formal definition as stated by the original\n      <a href="https://arxiv.org/pdf/1806.07366.pdf">\n       paper\n      </a>\n      :\n     </p>\n     <pre class="overflow-x-scroll font-mono"><code>Neural ODEs are a new family of deep neural network models. Instead of specifying a discrete sequence of \nhidden layers, we parameterize the derivative of the hidden state using a neural network.\n\nThe output of the network is computed using a blackbox differential equation solver.These are continuous-depth models that have constant memory \ncost, adapt their evaluation strategy to each input, and can explicitly trade numerical precision for speed.\n</code></pre>\n     <p>\n      In simple words perceive NeuralODEs as yet another type of layer like Linear, Conv2D, MHA...\n     </p>\n     <p>\n      In this tutorial we will be using\n      <a href="https://github.com/rtqichen/torchdiffeq">\n       torchdiffeq\n      </a>\n      . This library provides ordinary differential equation (ODE) solvers implemented in PyTorch framework. The library provides a clean API of ODE solvers for usage in deep learning applications. As the solvers are implemented in PyTorch, algorithms in this repository are fully supported to run on the GPU.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h2>\n      What will you learn after completing this tutorial ?\n      <a class="anchor-link" href="#What-will-you-learn-after-completing-this-tutorial-?">\n       \xb6\n      </a>\n     </h2>\n     <ol>\n      <li>\n       How to implement a Neural ODE in a Neural Network ?\n      </li>\n      <li>\n       Using torchdiffeq with deepchem.\n      </li>\n     </ol>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h3 id="Installing-Libraries">\n      Installing Libraries\n      <a class="anchor-link" href="#Installing-Libraries">\n       \xb6\n      </a>\n     </h3>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[1]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-python">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">torchdiffeq</span>\n<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">pre</span> <span class="n">deepchem</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll font-mono">Collecting torchdiffeq\n  Downloading torchdiffeq-0.2.2-py3-none-any.whl (31 kB)\nRequirement already satisfied: torch&gt;=1.3.0 in /usr/local/lib/python3.7/dist-packages (from torchdiffeq) (1.10.0+cu111)\nRequirement already satisfied: scipy&gt;=1.4.0 in /usr/local/lib/python3.7/dist-packages (from torchdiffeq) (1.4.1)\nRequirement already satisfied: numpy&gt;=1.13.3 in /usr/local/lib/python3.7/dist-packages (from scipy&gt;=1.4.0-&gt;torchdiffeq) (1.21.5)\nRequirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from torch&gt;=1.3.0-&gt;torchdiffeq) (3.10.0.2)\nInstalling collected packages: torchdiffeq\nSuccessfully installed torchdiffeq-0.2.2\nCollecting deepchem\n  Downloading deepchem-2.6.1-py3-none-any.whl (608 kB)\n     |████████████████████████████████| 608 kB 8.9 MB/s \nRequirement already satisfied: scipy in /usr/local/lib/python3.7/dist-packages (from deepchem) (1.4.1)\nRequirement already satisfied: scikit-learn in /usr/local/lib/python3.7/dist-packages (from deepchem) (1.0.2)\nRequirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from deepchem) (1.3.5)\nCollecting rdkit-pypi\n  Downloading rdkit_pypi-2021.9.4-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (20.6 MB)\n     |████████████████████████████████| 20.6 MB 8.2 MB/s \nRequirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from deepchem) (1.1.0)\nRequirement already satisfied: numpy&gt;=1.21 in /usr/local/lib/python3.7/dist-packages (from deepchem) (1.21.5)\nRequirement already satisfied: python-dateutil&gt;=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas-&gt;deepchem) (2.8.2)\nRequirement already satisfied: pytz&gt;=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas-&gt;deepchem) (2018.9)\nRequirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&gt;=2.7.3-&gt;pandas-&gt;deepchem) (1.15.0)\nRequirement already satisfied: Pillow in /usr/local/lib/python3.7/dist-packages (from rdkit-pypi-&gt;deepchem) (7.1.2)\nRequirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn-&gt;deepchem) (3.1.0)\nInstalling collected packages: rdkit-pypi, deepchem\nSuccessfully installed deepchem-2.6.1 rdkit-pypi-2021.9.4\n</pre>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h3 id="Import-Libraries">\n      Import Libraries\n      <a class="anchor-link" href="#Import-Libraries">\n       \xb6\n      </a>\n     </h3>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[2]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-python">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="kn">import</span> <span class="nn">torch</span>\n<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>\n\n<span class="kn">from</span> <span class="nn">torchdiffeq</span> <span class="kn">import</span> <span class="n">odeint</span>\n<span class="kn">import</span> <span class="nn">math</span>\n<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>\n\n<span class="kn">import</span> <span class="nn">deepchem</span> <span class="k">as</span> <span class="nn">dc</span>\n<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      Before diving into the core of this tutorial , let\'s first acquaint ourselves with usage of torchdiffeq. Let\'s solve following differential equation .\n     </p>\n     <p>\n      $ \\frac{dz(t)}{dt} = f(t) = t $\n     </p>\n     <p>\n      when $z(0) = 0$\n     </p>\n     <p>\n      The process to do it by hand is :\n     </p>\n     <p>\n      $\\int dz = \\int tdt+C　\\\\\\ z(t) = \\frac{t^2}{2} + C$\n     </p>\n     <p>\n      Let\'s solve it using ODE Solver called\n      <code>\n       odeint\n      </code>\n      from torchdiffeq\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[3]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-python">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">z</span><span class="p">):</span>\n  <span class="k">return</span> <span class="n">t</span>\n\n<span class="n">z0</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>\n<span class="n">t</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>\n<span class="n">out</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">t</span><span class="p">);</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      Let\'s plot our result .It should be a parabola (remember general equation of parabola as $x^2 = 4ay$ )\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[4]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-python">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="s1">\'go--\'</span><span class="p">)</span>\n<span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">\'equal\'</span><span class="p">,</span><span class="s1">\'datalim\'</span><span class="p">)</span>\n<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>\n<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">\n      <pre class="overflow-x-scroll font-mono">/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:2: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.\n  \n</pre>\n     </div>\n    </div>\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">\n      <img alt="No description has been provided for this image" class="jp-needs-light-background" src="data:image/png;base64,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"/>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h1>\n      What is Neural Differential Equation ?\n      <a class="anchor-link" href="#What-is-Neural-Differential-Equation-?">\n       \xb6\n      </a>\n     </h1>\n     <p>\n      A neural differential equation is a differential equation using a neural network to parameterize the vector field. The canonical example is a neural ordinary differential equation :\n     </p>\n     <p>\n      $y(0) = y_0$\n     </p>\n     <p>\n      $\\frac{dy}{dt} (t) = f_\\theta(t,y(t)) $\n     </p>\n     <p>\n      Here θ represents some vector of learnt parameters, $ f_\\theta : \\mathbb{R} \\times \\mathbb{R}^{d_1 \\times ... \\times d_k}$ is any standard neural architecture and $ y:[0, T] → \\mathbb{R}^{d_1 \\times ... d_k} $ is the solution. For many applications $f_\\theta$ will just be a simple feedforward network. Here $d_i $ is the dimension.\n     </p>\n     <p>\n      <a href="https://arxiv.org/pdf/2202.02435.pdf">\n       Reference\n      </a>\n     </p>\n     <p>\n      The central idea now is to use a differential equation solver as part of a learnt differentiable computation graph (the sort of computation graph ubiquitous to deep\nlearning)\n     </p>\n     <p>\n      <img alt="sample.jpg" src="data:image/jpeg;base64,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"/>\n     </p>\n     <p>\n      As simple example, suppose we observe some picture $y_0 \\in \\mathbb{R}^{3 \\times 32 \\times 3}$ (RGB and 32x32 pixels), and wish to classify it as a picture of a cat or as a picture of a dog.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      With torchdiffeq , we can solve even complex higher order differential equations too. Following is a real world example , a set of differential equations that models a spring - mass damper system\n     </p>\n     <p>\n      $\\dot{x}= \\frac{dx}{dt} $\n     </p>\n     <p>\n      $\\ddot{x} = -(k/m) x + p \\dot{x} $\n     </p>\n     <p>\n      $\\dddot{x} = -r \\ddot{x} + gx$\n     </p>\n     <p>\n      with initial state t=0 , x=1\n     </p>\n     <p>\n      $$\n\\left[ \\begin{array}{c} \\dot{x} \\\\\\ \\ddot{x} \\\\\\ \\dddot{x} \\end{array} \\right] = \\left[\\begin{array}{cc} 0 &amp; 1 &amp; 0\\\\\\ -\\frac{k}{m} &amp; p &amp; 0\\\\\\ 0 &amp; g &amp; -r \\end{array} \\right]\n\\left[ \\begin{array}{c} x \\\\\\ \\dot{x}\\\\\\ \\ddot{x} \\\\\\ \\end{array} \\right]\n$$\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      The right hand side may be regarded as a particular differentiable computation graph. The parameters may be fitted by setting up a loss between the trajectories of the model and the observed trajectories in the data, backpropagating through the model, and applying stochastic gradient descent.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[5]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-python">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="k">class</span> <span class="nc">SystemOfEquations</span><span class="p">:</span>\n\n  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">km</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>\n    <span class="bp">self</span><span class="o">.</span><span class="n">mat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="n">km</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="o">-</span><span class="n">r</span><span class="p">]])</span>\n\n  <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">dx0</span><span class="p">,</span> <span class="n">ddx0</span><span class="p">):</span>\n    <span class="n">y0</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">dx0</span><span class="p">,</span> <span class="n">ddx0</span><span class="p">])</span>\n    <span class="n">out</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>\n    <span class="k">return</span> <span class="n">out</span>\n  \n  <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>\n    <span class="n">out</span> <span class="o">=</span> <span class="n">y</span><span class="nd">@self</span><span class="o">.</span><span class="n">mat</span> \n    <span class="k">return</span> <span class="n">out</span>\n\n\n<span class="n">x0</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>\n<span class="n">dx0</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>\n<span class="n">ddx0</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>\n\n<span class="n">t</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>\n<span class="n">solver</span> <span class="o">=</span> <span class="n">SystemOfEquations</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>\n<span class="n">out</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">dx0</span><span class="p">,</span> <span class="n">ddx0</span><span class="p">)</span>\n\n<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="s1">\'r\'</span><span class="p">)</span>\n<span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>\n<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>\n<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">\n      <pre class="overflow-x-scroll font-mono">/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:25: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.\n</pre>\n     </div>\n    </div>\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">\n      <img alt="No description has been provided for this image" class="jp-needs-light-background" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWoAAAEDCAYAAAAcI05xAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAASUklEQVR4nO3de7BdZX3G8e8vV3IBgg1kMDAkIsNlMgqcCCqtEtA2BQc6zjiDVQRF0VFatc60Oupoq9Oq7XRgRoqgWJQiGYpUULwxkAioCByqXBIi1HBJwlVIw0lITJpf/1j7aMSEs/c+Z+31Lvh+ZvasfVl7v8+Ck+e8ebP23pGZSJLKNanpAJKk52dRS1LhLGpJKpxFLUmFs6glqXAWtSQVrraijoivRsTjEXF3F/u+LyLuioifR8TNEXFE5/4/iojlETESEV+sK6sklSzqOo86Il4HjABfz8xFY+y7V2Zu7Fw/BXh/Zi6NiFnAUcAiYFFmnlNLWEkqWG0z6sy8EXhq5/si4uCI+H5EDEfETRFxWGffjTvtNgvIzv2bMvNmYEtdOSWpdFMGPN5FwPsy876IOBb4N+AEgIj4APA3wLTR+yRJAyzqiJgNvBb4z4gYvXv66JXMPB84PyL+EvgEcMagsklSyQY5o54EbMjMI8fYbxlwwQDySFIrDOz0vM469JqIeAtAVF7ZuX7ITrueDNw3qFySVLo6z/q4HDgemAs8BnwKuIFqtrw/MBVYlpn/EBHnAW8AtgFPA+dk5j2d13kA2Itq7XoD8KeZubKW0JJUoNqKWpI0MXxnoiQVrpZ/TJw7d24uWLCgr+du2rSJWbNmTWygAWp7fmj/MbQ9P7T/GMzfu+Hh4Sczc99dPpiZE34ZGhrKfi1fvrzv55ag7fkz238Mbc+f2f5jMH/vgNtzN53q0ockFc6ilqTCWdSSVDiLWpIKZ1FLUuEsakkqnEUtSYWzqCVpIlxzDXzhC7W8tEUtSRPh29+Gc8+t5aUtakmaCFu3wvTpY+/XB4takiaCRS1JhbOoJalwFrUkFc6ilqTCWdSSVDiLWpIKZ1FLUuEsakkqnEUtSYWzqCWpcBa1JBXOopakwlnUklSw7dthxw6LWpKKtXVrtbWoJalQFrUkFW7LlmprUUtSoZxRS1LhLGpJKpxFLUmFs6glqXAWtSQVzqKWpMJZ1JJUOItakgrXdFFHxB4RcWtE/CIi7omIv68liSS1Vc1FPaWbCMAJmTkSEVOBmyPie5l5Sy2JJKltmi7qzExgpHNzaueStaSRpDaquaij6uExdoqYDAwDLwfOz8y/28U+ZwNnA8ybN29o2bJlfQUaGRlh9uzZfT23BG3PD+0/hrbnh/Yfw4st/4HLlnHwhRdy07XX8n8zZ/Y15pIlS4Yzc/EuH8zMri/AHGA5sOj59hsaGsp+LV++vO/nlqDt+TPbfwxtz5/Z/mN40eX/zGcyIXPr1r7HBG7P3XRqT2d9ZOaGTlEv7etXhiS9EI0ufUydWsvLd3PWx74RMadzfQbwRuDeWtJIUhtt2QIzZkBELS/fzVkf+wNf66xTTwKuyMzv1JJGktro2Weroq5JN2d93AkcVVsCSWq7movadyZK0ng9+yzssUdtL29RS9J4ja5R18SilqTxculDkgpnUUtS4VyjlqTCuUYtSYVz6UOSCmdRS1LhXKOWpMK5Ri1JBct06UOSirZtG+zYYVFLUrGefbbaukYtSYXasqXaOqOWpEKNzqgtakkqlEUtSYVzjVqSCucatSQVzqUPSSqcRS1JhXONWpIK5xq1JBXOpQ9JKtzmzdXWopakQo0W9axZtQ1hUUvSeGzaBJMnw7RptQ1hUUvSeGzaVM2mI2obwqKWpPEYLeoaWdSSNB4WtSQVbtMmmDmz1iEsakkaD2fUklQ4i1qSCmdRS1LhLGpJKpxFLUmF27zZopakYmWWMaOOiAMjYnlErIyIeyLig7UmkqS22LoVduyovaindLHPduAjmXlHROwJDEfEdZm5stZkklS6TZuqbdMz6sx8JDPv6Fx/BlgFzK81lSS1wWhR1/zOxMjM7neOWADcCCzKzI3Peexs4GyAefPmDS1btqyvQCMjI8yePbuv55ag7fmh/cfQ9vzQ/mN4seSf+eCDHHPmmaz8xCd4/MQTxzXmkiVLhjNz8S4fzMyuLsBsYBh481j7Dg0NZb+WL1/e93NL0Pb8me0/hrbnz2z/Mbxo8t92WyZkXn31uMcEbs/ddGpXZ31ExFTgm8BlmXnVuH5tSNILRSlr1BERwMXAqsz811rTSFKblFLUwHHA6cAJEfHzzuWkWlNJUhsMqKjHPD0vM28G6vuOGUlqq5GRarvnnrUO4zsTJalfGzsnv+21V63DWNSS1K9nnqm2zqglqVAbN8Iee8DUqbUOY1FLUr82bqx9Ng0WtST175lnal+fBotakvq3caNFLUlFe+YZlz4kqWjOqCWpcM6oJalwzqglqXDOqCWpYNu3w7PPOqOWpGKNvn3copakQo1+IJNLH5JUKGfUklQ4Z9SSVLgNG6rt3nvXPpRFLUn9ePrparvPPrUPZVFLUj8sakkqnEUtSYXbsKH69vGav90FLGpJ6s/TTw9kNg0WtST1x6KWpMJZ1JJUOItakgpnUUtS4Z5+GubMGchQFrUk9WrbNhgZcUYtScUa/ZwPi1qSCjXAdyWCRS1JvXvyyWo7d+5AhrOoJalXTzxRbffddyDDWdSS1CuLWpIKZ1FLUuEefxxmz4YZMwYynEUtSb164omBzabBopak3pVW1BHx1Yh4PCLuHkQgSSpeaUUNXAIsrTmHJLVHaUWdmTcCTw0giySVL3PgRR2ZOfZOEQuA72TmoufZ52zgbIB58+YNLVu2rK9AIyMjzJ49u6/nlqDt+aH9x9D2/ND+Y3gh55+8eTN/cvLJ/M9738vDp502YWMuWbJkODMX7/LBzBzzAiwA7u5m38xkaGgo+7V8+fK+n1uCtufPbP8xtD1/ZvuP4QWdf/XqTMi89NIJHRO4PXfTqZ71IUm9WL++2r70pQMb0qKWpF6UWNQRcTnwU+DQiFgbEWfVH0uSCrVuXbWdP39gQ04Za4fMfOsggkhSK6xfX719fM89BzakSx+S1Iv16we67AEWtST1Zt06i1qSirZ+/UDXp8GilqTuZVZFvf/+Ax3Wopakbj32GGzdCgcdNNBhLWpJ6taaNdV24cKBDmtRS1K3Rot6wYKBDmtRS1K3Hnig2lrUklSoNWtgv/1g1qyBDmtRS1K31qwZ+Po0WNSS1D2LWpIKtnVrtUb98pcPfGiLWpK6cf/9sGMHHH74wIe2qCWpG6tWVVuLWpIKNVrUhx468KEtaknqxqpV1VvHZ84c+NAWtSR1Y+XKRpY9wKKWpLFt3VoV9ZFHNjK8RS1JY7nrLti2DYaGGhneopaksQwPV9ujj25keItaksYyPAz77NPIuxLBopaksf3sZ7B4MUQ0MrxFLUnP59e/hjvvhNe/vrEIFrUkPZ+bbqq2FrUkFWrFCpgxA171qsYiWNSStDuZcO218LrXwfTpjcWwqCVpd+69t/rUvFNPbTSGRS1Ju/Otb1XbU05pNIZFLUm7kglf/zq89rUwf36jUSxqSdqVW26plj7OOqvpJBa1JO3SeefBnnvCW97SdBKLWpKea8bDD8MVV8D731+VdcMsakl6joO/9KXqCwI+/OGmowAwpekAklSUK69k7k9+Ap//PMyb13QawBm1JP3O6tXwrnex8bDD4EMfajrNb1nUkgTwy1/CiSfCtGnc8+lPw7RpTSf6LYta0otbJnzjG3DMMfCb38ANN7C1kCWPUV0VdUQsjYjVEXF/RHy07lCSVLuRkd8V9NveBocdVp07/YpXNJ3sD4z5j4kRMRk4H3gjsBa4LSKuycyVdYeTpL5lwpYtVSE/9RQ89FB1Wb26+iKAW2+tHl+wAC6+GN7xDphS5vkVkZnPv0PEa4BPZ+afdW5/DCAz/2l3z1m8eHHefvvtvaeZPp3cto1o6FsUJkJmtjo/tP8Y2p4f2n8Mv5d/dx2z8/GN0UN9htj9Y1OnVp+GN2tWdZk+vbrssQdMn86GDRuYM2dO72MeeSSce25fcSNiODMX7+qxbn59zAce3un2WuDYXQxyNnA2wLx581ixYkXPQf84gkmTJlHD/7LBiWh3fmj/MbQ9P7wgjiFHi7ibXzjj/aX03FJ+7tij/z07t2PHDmLzZmJk5A9easfkycycMYPNe+/NtjlzyB5m2SNr13J/H903lgmb52fmRcBFUM2ojz/++N5fZMsWVqxYQV/PLUTb80P7j6Ht+aH9x9Ca/Dt2VEsj69bBgw/Cr37FpOFhtl93HTMffhgefbRaEvnUp+Cgg8Z8uTnAATXE7Kao1wEH7nT7gM59ktRukybBXntVl8MP/+3dt65YwfFz58KXvwwXXli9nfz88+GMM5qJ2cU+twGHRMTCiJgGnAZcU28sSWrYokXVBzOtXl19DdeZZ8JnP9tIlDGLOjO3A+cAPwBWAVdk5j11B5OkIhx0EFx3HZx+Onzyk3DBBQOP0NUadWZ+F/huzVkkqUxTpsAll8Cvf129tXzx4oF+2a3vTJSkbkyaBJdeCvvtB+95D2zfPrihBzaSJLXdS15SnSf9i19Ub5IZEItaknrx5jfDscfC5z4H27YNZEiLWpJ6EQEf/zg88ABceeVAhrSoJalXJ58MCxcObPnDopakXk2aBO98J1x/PaxZU/9wtY8gSS9Eb397tb3qqtqHsqglqR8LF1afXX311bUPZVFLUr9OPRV+/GN48slah7GoJalfJ51UfQJfDR9tujOLWpL6NTRUffHAj35U6zAWtST1a+pUOO44Z9SSVLTXvx7uvrv6wKaaWNSSNB7Hdr6Z8I47ahvCopak8Tj66Go7PFzbEBa1JI3HPvvAy15mUUtS0YaGLGpJKtpRR1Wf+bFxYy0vb1FL0niNfoP5vffW8vIWtSSN12hRr1pVy8tb1JI0XgcfXL35xaKWpEJNmQKHHOLShyQV7fDDa5tRT6nlVSXpxWbp0uqc6szqexUnkEUtSRPh3e+uLjVw6UOSCmdRS1LhLGpJKpxFLUmFs6glqXAWtSQVzqKWpMJZ1JJUuMjMiX/RiCeAB/t8+lzgyQmMM2htzw/tP4a254f2H4P5e3dQZu67qwdqKerxiIjbM3Nx0zn61fb80P5jaHt+aP8xmH9iufQhSYWzqCWpcCUW9UVNBxintueH9h9D2/ND+4/B/BOouDVqSdLvK3FGLUnaiUUtSYUrpqgjYmlErI6I+yPio03n6VVEHBgRyyNiZUTcExEfbDpTPyJickT8d0R8p+ks/YiIORFxZUTcGxGrIuI1TWfqRUR8uPPzc3dEXB4RezSdaSwR8dWIeDwi7t7pvpdExHURcV9nu0+TGZ/PbvL/c+dn6M6I+K+ImNNkxiKKOiImA+cDfw4cAbw1Io5oNlXPtgMfycwjgFcDH2jhMQB8EKjni98G4zzg+5l5GPBKWnQsETEf+GtgcWYuAiYDpzWbqiuXAEufc99Hgesz8xDg+s7tUl3CH+a/DliUma8Afgl8bNChdlZEUQPHAPdn5q8y8zfAMuDUhjP1JDMfycw7OtefoSqI+c2m6k1EHACcDHyl6Sz9iIi9gdcBFwNk5m8yc0OzqXo2BZgREVOAmcD6hvOMKTNvBJ56zt2nAl/rXP8a8BcDDdWDXeXPzB9m5vbOzVuAAwYebCelFPV84OGdbq+lZSW3s4hYABwF/KzZJD07F/hbYEfTQfq0EHgC+PfO8s1XImJW06G6lZnrgH8BHgIeAf43M3/YbKq+zcvMRzrXHwXmNRlmnN4FfK/JAKUU9QtGRMwGvgl8KDM3Np2nWxHxJuDxzBxuOss4TAGOBi7IzKOATZT9V+7f01nHPZXqF85LgVkR8fZmU41fVucAt/I84Ij4ONWy5mVN5iilqNcBB+50+4DOfa0SEVOpSvqyzLyq6Tw9Og44JSIeoFp6OiEi/qPZSD1bC6zNzNG/yVxJVdxt8QZgTWY+kZnbgKuA1zacqV+PRcT+AJ3t4w3n6VlEnAm8CXhbNvyGk1KK+jbgkIhYGBHTqP4B5ZqGM/UkIoJqbXRVZv5r03l6lZkfy8wDMnMB1X//GzKzVbO5zHwUeDgiDu3cdSKwssFIvXoIeHVEzOz8PJ1Ii/4x9DmuAc7oXD8DuLrBLD2LiKVUy4CnZObmpvMUUdSdRftzgB9Q/WBekZn3NJuqZ8cBp1PNRH/euZzUdKgXob8CLouIO4EjgX9sOE/XOn8TuBK4A7iL6s9nUW9l3pWIuBz4KXBoRKyNiLOAzwFvjIj7qP6m8LkmMz6f3eT/IrAncF3nz/KXGs3oW8glqWxFzKglSbtnUUtS4SxqSSqcRS1JhbOoJalwFrUkFc6ilqTC/T+IQ/y7N/D9VgAAAABJRU5ErkJggg=="/>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      This is precisely the same procedure as the more general neural ODEs we introduced\nearlier. At first glance, the NDE approach of ‘putting a neural network in a differential\nequation’ may seem unusual, but it is actually in line with standard practice. All that\nhas happened is to change the parameterisation of the vector field.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h1>\n      Model\n      <a class="anchor-link" href="#Model">\n       \xb6\n      </a>\n     </h1>\n     <h3 id="Let-us-have-a-look-at-how-to-embed-an-ODEsolver-in-a-neural-network-.">\n      Let us have a look at how to embed an ODEsolver in a neural network .\n      <a class="anchor-link" href="#Let-us-have-a-look-at-how-to-embed-an-ODEsolver-in-a-neural-network-.">\n       \xb6\n      </a>\n     </h3>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[6]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-python">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="kn">from</span> <span class="nn">torchdiffeq</span> <span class="kn">import</span> <span class="n">odeint_adjoint</span> <span class="k">as</span> <span class="n">odeadj</span>\n\n<span class="k">class</span> <span class="nc">f</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>\n  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>\n    <span class="nb">super</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>\n    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>\n        <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span><span class="mi">124</span><span class="p">),</span>\n        <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>\n        <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">124</span><span class="p">,</span><span class="mi">124</span><span class="p">),</span>\n        <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>\n        <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">124</span><span class="p">,</span><span class="n">dim</span><span class="p">),</span>\n        <span class="n">nn</span><span class="o">.</span><span class="n">Tanh</span><span class="p">()</span>\n    <span class="p">)</span>\n\n  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>\n    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      <code>\n       function\n      </code>\n      f in above code cell , is wrapped in an\n      <code>\n       nn.Module\n      </code>\n      (see codecell below) thus forming the dynamics of $\\frac{dy}{dt} (t) = f_\\theta(t,y(t)) $ embedded within a neural Network.\nODE Block treats the received input x as the initial value of the differential equation. The integration interval of ODE Block is fixed at [0, 1]. And it returns the output of the layer at $ t = 1 $.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[7]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-python">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="k">class</span> <span class="nc">ODEBlock</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>\n  \n  <span class="c1"># This is ODEBlock. Think of it as a wrapper over ODE Solver , so as to easily connect it with our neurons !</span>\n\n  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>\n    <span class="nb">super</span><span class="p">(</span><span class="n">ODEBlock</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>\n    <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">f</span>\n    <span class="bp">self</span><span class="o">.</span><span class="n">integration_time</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>\n\n  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>\n    <span class="bp">self</span><span class="o">.</span><span class="n">integration_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">integration_time</span><span class="o">.</span><span class="n">type_as</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>\n    <span class="n">out</span> <span class="o">=</span> <span class="n">odeadj</span><span class="p">(</span>\n        <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span>\n        <span class="n">x</span><span class="p">,</span>\n        <span class="bp">self</span><span class="o">.</span><span class="n">integration_time</span>\n    <span class="p">)</span>\n\n    <span class="k">return</span> <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>\n\n\n<span class="k">class</span> <span class="nc">ODENet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>\n  \n  <span class="c1">#This is our main neural network that uses ODEBlock within a sequential module</span>\n\n  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_dim</span><span class="p">,</span> <span class="n">mid_dim</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">):</span>\n    <span class="nb">super</span><span class="p">(</span><span class="n">ODENet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>\n    <span class="n">fx</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">mid_dim</span><span class="p">)</span>\n    <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_dim</span><span class="p">,</span> <span class="n">mid_dim</span><span class="p">)</span>\n    <span class="bp">self</span><span class="o">.</span><span class="n">relu1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>\n    <span class="bp">self</span><span class="o">.</span><span class="n">norm1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">(</span><span class="n">mid_dim</span><span class="p">)</span>\n    <span class="bp">self</span><span class="o">.</span><span class="n">ode_block</span> <span class="o">=</span> <span class="n">ODEBlock</span><span class="p">(</span><span class="n">fx</span><span class="p">)</span>\n    <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>\n    <span class="bp">self</span><span class="o">.</span><span class="n">norm2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">(</span><span class="n">mid_dim</span><span class="p">)</span>\n    <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">mid_dim</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">)</span>\n\n  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>\n    <span class="n">batch_size</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\n    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>\n\n    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>\n    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu1</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>\n    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm1</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>\n    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ode_block</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>\n    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm2</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>\n    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>\n    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>\n\n    <span class="k">return</span> <span class="n">out</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      As mentioned before , Neural ODE Networks acts similar (has advantages though) to other neural networks , so we can solve any problem with them as the existing models do. We are gonna reuse the training process mentioned in\n      <a href="https://github.com/deepchem/deepchem/blob/master/examples/tutorials/Creating_Models_with_TensorFlow_and_PyTorch.ipynb">\n       this\n      </a>\n      deepchem tutorial.\n     </p>\n     <p>\n      So Rather than demonstrating how to use NeuralODE model with a normal dataset, we shall use the\n      <strong>\n       Delaney solubility dataset\n      </strong>\n      provided under\n      <strong>\n       deepchem\n      </strong>\n      . Our model will learn to predict the solubilities of molecules based on their extended-connectivity fingerprints (ECFPs) . For performance metrics we use\n      <a href="https://deepchem.readthedocs.io/en/latest/api_reference/metrics.html#deepchem.metrics.pearson_r2_score">\n       pearson_r2_score\n      </a>\n      . Here loss is computed directly from the model\'s output\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[8]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-python">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="n">tasks</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">transformers</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">molnet</span><span class="o">.</span><span class="n">load_delaney</span><span class="p">(</span><span class="n">featurizer</span><span class="o">=</span><span class="s1">\'ECFP\'</span><span class="p">,</span> <span class="n">splitter</span><span class="o">=</span><span class="s1">\'random\'</span><span class="p">)</span>\n<span class="n">train_set</span><span class="p">,</span> <span class="n">valid_set</span><span class="p">,</span> <span class="n">test_set</span> <span class="o">=</span> <span class="n">dataset</span>\n<span class="n">metric</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">Metric</span><span class="p">(</span><span class="n">dc</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">pearson_r2_score</span><span class="p">)</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h2>\n      Time to Train\n      <a class="anchor-link" href="#Time-to-Train">\n       \xb6\n      </a>\n     </h2>\n     <p>\n      We train our model for 50 epochs, with L2 as Loss Function.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[9]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-python">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="c1"># Like mentioned before one can use GPUs with PyTorch and torchdiffeq</span>\n<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cuda"</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">"cpu"</span><span class="p">)</span>\n\n\n<span class="n">model</span> <span class="o">=</span> <span class="n">ODENet</span><span class="p">(</span><span class="n">in_dim</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">mid_dim</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">out_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>\n<span class="n">model</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">TorchModel</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dc</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">L2Loss</span><span class="p">())</span>\n\n<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">nb_epoch</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>\n\n<span class="nb">print</span><span class="p">(</span><span class="s1">\'Training set score : \'</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">train_set</span><span class="p">,[</span><span class="n">metric</span><span class="p">]))</span>\n<span class="nb">print</span><span class="p">(</span><span class="s1">\'Test set score : \'</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_set</span><span class="p">,[</span><span class="n">metric</span><span class="p">]))</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll font-mono">Training set score :  {\'pearson_r2_score\': 0.9708644701066554}\nTest set score :  {\'pearson_r2_score\': 0.7104556551957734}\n</pre>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      Neural ODEs are invertible neural nets\n      <a href="https://proceedings.mlr.press/v119/zhang20h.html#:~:text=Neural%20ODEs%20and%20i%2DResNets,.approximate%20any%20continuous%20invertible%20mapping.">\n       Reference\n      </a>\n      Invertible neural networks have been a significant thread of research in the ICML community for several years. Such transformations can offer a range of unique benefits:\n     </p>\n     <ul>\n      <li>\n       They preserve information, allowing perfect reconstruction (up to numerical limits) and obviating the need to store hidden activations in memory for backpropagation.\n      </li>\n      <li>\n       They are often designed to track the changes in probability density that applying the transformation induces (as in normalizing flows).\n      </li>\n      <li>\n       Like autoregressive models,\n       <a href="https://arxiv.org/pdf/2006.00104.pdf">\n        normalizing flows\n       </a>\n       can be powerful generative models which allow exact likelihood computations; with the right architecture, they can also allow for much cheaper sampling than autoregressive models.\n      </li>\n     </ul>\n     <p>\n      While many researchers are aware of these topics and intrigued by several high-profile papers, few are familiar enough with the technical details to easily follow new developments and contribute. Many may also be unaware of the wide range of applications of invertible neural networks, beyond generative modelling and variational inference.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h1>\n      Congratulations! Time to join the Community!\n      <a class="anchor-link" href="#Congratulations!-Time-to-join-the-Community!">\n       \xb6\n      </a>\n     </h1>\n     <p>\n      Congratulations on completing this tutorial notebook! If you enjoyed working through the tutorial, and want to continue working with DeepChem, we encourage you to finish the rest of the tutorials in this series. You can also help the DeepChem community in the following ways:\n     </p>\n     <h2>\n      Star DeepChem on\n      <a href="https://github.com/deepchem/deepchem">\n       GitHub\n      </a>\n      <a class="anchor-link" href="#Star-DeepChem-on-GitHub">\n       \xb6\n      </a>\n     </h2>\n     <p>\n      This helps build awareness of the DeepChem project and the tools for open source drug discovery that we\'re trying to build.\n     </p>\n     <h2>\n      Join the DeepChem Gitter\n      <a class="anchor-link" href="#Join-the-DeepChem-Gitter">\n       \xb6\n      </a>\n     </h2>\n     <p>\n      The DeepChem\n      <a href="https://gitter.im/deepchem/Lobby">\n       Gitter\n      </a>\n      hosts a number of scientists, developers, and enthusiasts interested in deep learning for the life sciences. Join the conversation!\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n</main>\n'},i=a(7294),c=a(7466),o=a.n(c);let r=()=>((0,i.useEffect)(()=>{var s,n;null===(s=document.getElementsByClassName("scroll-nav")[0])||void 0===s||s.remove();let a=document.querySelector(".notebook"),p=document.querySelector(".notebook");p&&a&&o().init(a,{sections:"h1, h2",insertTarget:p,insertLocation:"after"}),null==MathJax||null===(n=MathJax.Hub)||void 0===n||n.Queue(["Typeset",MathJax.Hub])},[]),(0,p.jsx)("div",{className:"overflow-x-scroll",dangerouslySetInnerHTML:{__html:"".concat(t.html," ").concat(e.Z)}}));r.Layout=l.Z;var d=r}},function(s){s.O(0,[2443,9774,2888,179],function(){return s(s.s=5235)}),_N_E=s.O()}]);