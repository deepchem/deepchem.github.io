(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5767],{921:function(n,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tutorials/working-with-datasets",function(){return a(8046)}])},8046:function(n,t,a){"use strict";a.r(t),a.d(t,{default:function(){return r}});var s=a(5893),e=a(1618),p=a(6485),l={html:'<main>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h1>\n      Working With Datasets\n      <a class="anchor-link" href="#Working-With-Datasets">\n       \xb6\n      </a>\n     </h1>\n     <p>\n      Data is central to machine learning.  This tutorial introduces the\n      <code>\n       Dataset\n      </code>\n      class that DeepChem uses to store and manage data.  It provides simple but powerful tools for efficiently working with large amounts of data.  It also is designed to easily interact with other popular Python frameworks such as NumPy, Pandas, TensorFlow, and PyTorch.\n     </p>\n     <h2>\n      Colab\n      <a class="anchor-link" href="#Colab">\n       \xb6\n      </a>\n     </h2>\n     <p>\n      This tutorial and the rest in this sequence can be done in Google colab. If you\'d like to open this notebook in colab, you can use the following link.\n     </p>\n     <p>\n      <a href="https://colab.research.google.com/github/deepchem/deepchem/blob/master/examples/tutorials/Working_With_Datasets.ipynb">\n       <img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/>\n      </a>\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[\xa0]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="o">!</span>pip install --pre deepchem\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      We can now import the\n      <code>\n       deepchem\n      </code>\n      package to play with.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[1]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="kn">import</span> <span class="nn">deepchem</span> <span class="k">as</span> <span class="nn">dc</span>\n<span class="n">dc</span><span class="o">.</span><span class="n">__version__</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child jp-OutputArea-executeResult">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n      Out[1]:\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll font-mono">\'2.4.0-rc1.dev\'</pre>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h1>\n      Anatomy of a Dataset\n      <a class="anchor-link" href="#Anatomy-of-a-Dataset">\n       \xb6\n      </a>\n     </h1>\n     <p>\n      In the last tutorial we loaded the Delaney dataset of molecular solubilities.  Let\'s load it again.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[2]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="n">tasks</span><span class="p">,</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">transformers</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">molnet</span><span class="o">.</span><span class="n">load_delaney</span><span class="p">(</span><span class="n">featurizer</span><span class="o">=</span><span class="s1">\'GraphConv\'</span><span class="p">)</span>\n<span class="n">train_dataset</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">,</span> <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">datasets</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      We now have three Dataset objects: the training, validation, and test sets.  What information does each of them contain?  We can start to get an idea by printing out the string representation of one of them.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[3]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="nb">print</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">)</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll font-mono">&lt;DiskDataset X.shape: (113,), y.shape: (113, 1), w.shape: (113, 1), ids: [\'C1c2ccccc2c3ccc4ccccc4c13\' \'COc1ccccc1Cl\'\n \'COP(=S)(OC)Oc1cc(Cl)c(Br)cc1Cl\' ... \'CCSCCSP(=S)(OC)OC\' \'CCC(C)C\'\n \'COP(=O)(OC)OC(=CCl)c1cc(Cl)c(Cl)cc1Cl\'], task_names: [\'measured log solubility in mols per litre\']&gt;\n</pre>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      There\'s a lot of information there, so let\'s start at the beginning.  It begins with the label "DiskDataset".  Dataset is an abstract class.  It has a few subclasses that correspond to different ways of storing data.\n     </p>\n     <ul>\n      <li>\n       <code>\n        DiskDataset\n       </code>\n       is a dataset that has been saved to disk.  The data is stored in a way that can be efficiently accessed, even if the total amount of data is far larger than your computer\'s memory.\n      </li>\n      <li>\n       <code>\n        NumpyDataset\n       </code>\n       is an in-memory dataset that holds all the data in NumPy arrays.  It is a useful tool when manipulating small to medium sized datasets that can fit entirely in memory.\n      </li>\n      <li>\n       <code>\n        ImageDataset\n       </code>\n       is a more specialized class that stores some or all of the data in image files on disk.  It is useful when working with models that have images as their inputs or outputs.\n      </li>\n     </ul>\n     <p>\n      Now let\'s consider the contents of the Dataset.  Every Dataset stores a list of\n      <em>\n       samples\n      </em>\n      .  Very roughly speaking, a sample is a single data point.  In this case, each sample is a molecule.  In other datasets a sample might correspond to an experimental assay, a cell line, an image, or many other things.  For every sample the dataset stores the following information.\n     </p>\n     <ul>\n      <li>\n       The\n       <em>\n        features\n       </em>\n       , referred to as\n       <code>\n        X\n       </code>\n       .  This is the input that should be fed into a model to represent the sample.\n      </li>\n      <li>\n       The\n       <em>\n        labels\n       </em>\n       , referred to as\n       <code>\n        y\n       </code>\n       .  This is the desired output from the model.  During training, it tries to make the model\'s output for each sample as close as possible to\n       <code>\n        y\n       </code>\n       .\n      </li>\n      <li>\n       The\n       <em>\n        weights\n       </em>\n       , referred to as\n       <code>\n        w\n       </code>\n       .  This can be used to indicate that some data values are more important than others.  In later tutorials we will see examples of how this is useful.\n      </li>\n      <li>\n       An\n       <em>\n        ID\n       </em>\n       , which is a unique identifier for the sample.  This can be anything as long as it is unique.  Sometimes it is just an integer index, but in this dataset the ID is a SMILES string describing the molecule.\n      </li>\n     </ul>\n     <p>\n      Notice that\n      <code>\n       X\n      </code>\n      ,\n      <code>\n       y\n      </code>\n      , and\n      <code>\n       w\n      </code>\n      all have 113 as the size of their first dimension.  That means this dataset contains 113 samples.\n     </p>\n     <p>\n      The final piece of information listed in the output is\n      <code>\n       task_names\n      </code>\n      .  Some datasets contain multiple pieces of information for each sample.  For example, if a sample represents a molecule, the dataset might record the results of several different experiments on that molecule.  This dataset has only a single task: "measured log solubility in mols per litre".  Also notice that\n      <code>\n       y\n      </code>\n      and\n      <code>\n       w\n      </code>\n      each have shape (113, 1).  The second dimension of these arrays usually matches the number of tasks.\n     </p>\n     <h1>\n      Accessing Data from a Dataset\n      <a class="anchor-link" href="#Accessing-Data-from-a-Dataset">\n       \xb6\n      </a>\n     </h1>\n     <p>\n      There are many ways to access the data contained in a dataset.  The simplest is just to directly access the\n      <code>\n       X\n      </code>\n      ,\n      <code>\n       y\n      </code>\n      ,\n      <code>\n       w\n      </code>\n      , and\n      <code>\n       ids\n      </code>\n      properties.  Each of these returns the corresponding information as a NumPy array.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[4]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="n">test_dataset</span><span class="o">.</span><span class="n">y</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child jp-OutputArea-executeResult">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n      Out[4]:\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll font-mono">array([[-1.7065408738415053],\n       [0.2911162036252904],\n       [-1.4272475857596547],\n       [-0.9254664241210759],\n       [-1.9526976701170347],\n       [1.3514839414275706],\n       [-0.8591934405084332],\n       [-0.6509069205829855],\n       [-0.32900957160729316],\n       [0.6082797680572224],\n       [1.8295961803473488],\n       [1.6213096604219008],\n       [1.3751528641463715],\n       [0.45632528420252055],\n       [1.0532555151706793],\n       [-1.1053502367839627],\n       [-0.2011973889257683],\n       [0.3479216181504126],\n       [-0.9870056231899582],\n       [-0.8161160011602158],\n       [0.8402352107014712],\n       [0.22815686919328],\n       [0.06247441016167367],\n       [1.040947675356903],\n       [-0.5197810887208284],\n       [0.8023649343513898],\n       [-0.41895147793873655],\n       [-2.5964923680684198],\n       [1.7443880585596654],\n       [0.45206487811313645],\n       [0.233837410645792],\n       [-1.7917489956291888],\n       [0.7739622270888287],\n       [1.0011838851893173],\n       [-0.05445006806920272],\n       [1.1043803882432892],\n       [0.7597608734575482],\n       [-0.7001382798380905],\n       [0.8213000725264304],\n       [-1.3136367567094103],\n       [0.4567986626568967],\n       [-0.5732728540653187],\n       [0.4094608172192949],\n       [-0.3242757870635329],\n       [-0.049716283525442634],\n       [-0.39054877067617544],\n       [-0.08095926151425996],\n       [-0.2627365879946506],\n       [-0.5467636606202616],\n       [1.997172153196459],\n       [-0.03551492989416198],\n       [1.4508934168465344],\n       [-0.8639272250521937],\n       [0.23904457364392848],\n       [0.5278054308132993],\n       [-0.48475108309700315],\n       [0.2248432200126478],\n       [0.3431878336066523],\n       [1.5029650468278963],\n       [-0.4946920306388995],\n       [0.3479216181504126],\n       [0.7928973652638694],\n       [0.5609419226196206],\n       [-0.13965818985688602],\n       [-0.13965818985688602],\n       [0.15857023640000523],\n       [1.6071083067906202],\n       [1.9006029485037514],\n       [-0.7171799041956278],\n       [-0.8165893796145915],\n       [-0.13019062076936566],\n       [-0.24380144981960986],\n       [-0.14912575894440638],\n       [0.9538460397517154],\n       [-0.07811899078800374],\n       [-0.18226225075072758],\n       [0.2532459272752089],\n       [0.6887541053011454],\n       [0.044012650441008896],\n       [-0.5514974451640217],\n       [-0.2580028034508905],\n       [-0.021313576262881533],\n       [-2.4128215277705247],\n       [0.07336211461232214],\n       [0.9017744097703536],\n       [1.9384732248538328],\n       [0.8402352107014712],\n       [-0.10652169805056463],\n       [1.07692443788948],\n       [-0.403803367398704],\n       [1.2662758196398873],\n       [-0.2532690189071302],\n       [0.29064282517091444],\n       [0.9443784706641951],\n       [-0.41563782875810434],\n       [-0.7370617992794205],\n       [-1.0012069768212388],\n       [0.46626623174441706],\n       [0.3758509469585975],\n       [-0.46628932337633816],\n       [1.2662758196398873],\n       [-1.4968342185529295],\n       [-0.17800184466134344],\n       [0.8828392715953128],\n       [-0.6083028596891439],\n       [-2.170451759130003],\n       [0.32898647997537184],\n       [0.3005837727128107],\n       [0.6461500444073038],\n       [1.5058053175541524],\n       [-0.007585601085977053],\n       [-0.049716283525442634],\n       [-0.6849901692980588]], dtype=object)</pre>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      This is a very easy way to access data, but you should be very careful about using it.  This requires the data for all samples to be loaded into memory at once.  That\'s fine for small datasets like this one, but for large datasets it could easily take more memory than you have.\n     </p>\n     <p>\n      A better approach is to iterate over the dataset.  That lets it load just a little data at a time, process it, then free the memory before loading the next bit.  You can use the\n      <code>\n       itersamples()\n      </code>\n      method to iterate over samples one at a time.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[5]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="k">for</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">test_dataset</span><span class="o">.</span><span class="n">itersamples</span><span class="p">():</span>\n    <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll font-mono">[-1.70654087] C1c2ccccc2c3ccc4ccccc4c13\n[0.2911162] COc1ccccc1Cl\n[-1.42724759] COP(=S)(OC)Oc1cc(Cl)c(Br)cc1Cl\n[-0.92546642] ClC(Cl)CC(=O)NC2=C(Cl)C(=O)c1ccccc1C2=O\n[-1.95269767] ClC(Cl)C(c1ccc(Cl)cc1)c2ccc(Cl)cc2 \n[1.35148394] COC(=O)C=C\n[-0.85919344] CN(C)C(=O)Nc2ccc(Oc1ccc(Cl)cc1)cc2\n[-0.65090692] N(=Nc1ccccc1)c2ccccc2\n[-0.32900957] CC(C)c1ccc(C)cc1\n[0.60827977] Oc1c(Cl)cccc1Cl\n[1.82959618] OCC2OC(OC1(CO)OC(CO)C(O)C1O)C(O)C(O)C2O \n[1.62130966] OC1C(O)C(O)C(O)C(O)C1O\n[1.37515286] Cn2c(=O)n(C)c1ncn(CC(O)CO)c1c2=O\n[0.45632528] OCC(NC(=O)C(Cl)Cl)C(O)c1ccc(cc1)N(=O)=O\n[1.05325552] CCC(O)(CC)CC\n[-1.10535024] CC45CCC2C(CCC3CC1SC1CC23C)C4CCC5O\n[-0.20119739] Brc1ccccc1Br\n[0.34792162] Oc1c(Cl)cc(Cl)cc1Cl\n[-0.98700562] CCCN(CCC)c1c(cc(cc1N(=O)=O)S(N)(=O)=O)N(=O)=O\n[-0.816116] C2c1ccccc1N(CCF)C(=O)c3ccccc23 \n[0.84023521] CC(C)C(=O)C(C)C\n[0.22815687] O=C1NC(=O)NC(=O)C1(C(C)C)CC=C(C)C\n[0.06247441] c1c(O)C2C(=O)C3cc(O)ccC3OC2cc1(OC)\n[1.04094768] Cn1cnc2n(C)c(=O)n(C)c(=O)c12\n[-0.51978109] CC(=O)SC4CC1=CC(=O)CCC1(C)C5CCC2(C)C(CCC23CCC(=O)O3)C45\n[0.80236493] Cc1ccc(O)cc1C\n[-0.41895148] O(c1ccccc1)c2ccccc2\n[-2.59649237] Clc1cc(Cl)c(cc1Cl)c2cc(Cl)c(Cl)cc2Cl \n[1.74438806] NC(=O)c1cccnc1 \n[0.45206488] Sc1ccccc1\n[0.23383741] CNC(=O)Oc1cc(C)cc(C)c1\n[-1.791749] ClC1CC2C(C1Cl)C3(Cl)C(=C(Cl)C2(Cl)C3(Cl)Cl)Cl\n[0.77396223] CSSC\n[1.00118389] NC(=O)c1ccccc1\n[-0.05445007] Clc1ccccc1Br\n[1.10438039] COC(=O)c1ccccc1OC2OC(COC3OCC(O)C(O)C3O)C(O)C(O)C2O\n[0.75976087] CCCCC(O)CC\n[-0.70013828] CCN2c1nc(C)cc(C)c1NC(=O)c3cccnc23 \n[0.82130007] Oc1cc(Cl)cc(Cl)c1\n[-1.31363676] Cc1cccc2c1ccc3ccccc32\n[0.45679866] CCCCC(CC)CO\n[-0.57327285] CC(C)N(C(C)C)C(=O)SCC(=CCl)Cl\n[0.40946082] Cc1ccccc1\n[-0.32427579] Clc1cccc(n1)C(Cl)(Cl)Cl\n[-0.04971628] C1CCC=CCC1\n[-0.39054877] CN(C)C(=S)SSC(=S)N(C)C \n[-0.08095926] COC1=CC(=O)CC(C)C13Oc2c(Cl)c(OC)cc(OC)c2C3=O\n[-0.26273659] CCCCCCCCCCO\n[-0.54676366] CCC(C)(C)CC\n[1.99717215] CNC(=O)C(C)SCCSP(=O)(OC)(OC)\n[-0.03551493] Oc1cc(Cl)c(Cl)c(Cl)c1Cl\n[1.45089342] CCCC=O\n[-0.86392723] CC4CC3C2CCC1=CC(=O)C=CC1(C)C2(F)C(O)CC3(C)C4(O)C(=O)COC(C)=O \n[0.23904457] CCCC\n[0.52780543] COc1ccccc1O\n[-0.48475108] CC1CC2C3CCC(O)(C(=O)C)C3(C)CC(O)C2(F)C4(C)C=CC(=O)C=C14\n[0.22484322] ClC(Cl)C(Cl)(Cl)Cl\n[0.34318783] CCOC(=O)c1ccccc1C(=O)OCC\n[1.50296505] CC(C)CO\n[-0.49469203] CC(C)Cc1ccccc1\n[0.34792162] ICI\n[0.79289737] CCCC(O)CCC\n[0.56094192] CCCCCOC(=O)C\n[-0.13965819] Oc1c(Cl)c(Cl)cc(Cl)c1Cl\n[-0.13965819] CCCc1ccccc1\n[0.15857024] FC(F)(Cl)C(F)(F)Cl\n[1.60710831] CC=CC=O\n[1.90060295] CN(C)C(=O)N(C)C \n[-0.7171799] Cc1cc(C)c(C)cc1C\n[-0.81658938] CC(=O)OC3(CCC4C2CCC1=CC(=O)CCC1C2CCC34C)C#C\n[-0.13019062] CCOP(=S)(OCC)N2C(=O)c1ccccc1C2=O\n[-0.24380145] c1ccccc1NC(=O)c2c(O)cccc2\n[-0.14912576] CCN(CC)C(=S)SCC(Cl)=C\n[0.95384604] ClCC\n[-0.07811899] CC(=O)Nc1cc(NS(=O)(=O)C(F)(F)F)c(C)cc1C\n[-0.18226225] O=C(C=CC=Cc2ccc1OCOc1c2)N3CCCCC3\n[0.25324593] CC/C=C\\C\n[0.68875411] CNC(=O)ON=C(CSC)C(C)(C)C \n[0.04401265] O=C2NC(=O)C1(CCCCCCC1)C(=O)N2\n[-0.55149745] c1(C(C)(C)C)cc(C(C)(C)C)cc(OC(=O)NC)c1\n[-0.2580028] Oc2cc(O)c1C(=O)CC(Oc1c2)c3ccc(O)c(O)c3\n[-0.02131358] O=C(c1ccccc1)c2ccccc2\n[-2.41282153] CCCCCCCCCCCCCCCCCCCC\n[0.07336211] N(Nc1ccccc1)c2ccccc2 \n[0.90177441] CCC(CC)CO\n[1.93847322] Oc1ccncc1\n[0.84023521] Cl\\C=C/Cl\n[-0.1065217] CC1CCCC1\n[1.07692444] CC(C)CC(C)O\n[-0.40380337] O2c1ccc(N)cc1N(C)C(=O)c3cc(C)ccc23 \n[1.26627582] CC(C)(C)CO\n[-0.25326902] CC(C)(C)C(=O)C(Oc1ccc(Cl)cc1)n2cncn2\n[0.29064283] Cc1cc(no1)C(=O)NNCc2ccccc2\n[0.94437847] CC=C\n[-0.41563783] Oc1ccc(Cl)cc1Cc2cc(Cl)ccc2O\n[-0.7370618] CCOC(=O)Nc2cccc(OC(=O)Nc1ccccc1)c2 \n[-1.00120698] O=C1c2ccccc2C(=O)c3ccccc13\n[0.46626623] CCCCCCC(C)O\n[0.37585095] CC1=C(C(=O)Nc2ccccc2)S(=O)(=O)CCO1\n[-0.46628932] CCCCc1ccccc1\n[1.26627582] O=C1NC(=O)C(=O)N1 \n[-1.49683422] COP(=S)(OC)Oc1ccc(Sc2ccc(OP(=S)(OC)OC)cc2)cc1\n[-0.17800184] NS(=O)(=O)c1cc(ccc1Cl)C2(O)NC(=O)c3ccccc23\n[0.88283927] CC(C)COC(=O)C\n[-0.60830286] CC(C)C(C)(C)C\n[-2.17045176] Clc1ccc(c(Cl)c1Cl)c2c(Cl)cc(Cl)c(Cl)c2Cl \n[0.32898648] N#Cc1ccccc1C#N\n[0.30058377] Cc1cccc(c1)N(=O)=O\n[0.64615004] FC(F)(F)C(Cl)Br \n[1.50580532] CNC(=O)ON=C(SC)C(=O)N(C)C\n[-0.0075856] CCSCCSP(=S)(OC)OC\n[-0.04971628] CCC(C)C\n[-0.68499017] COP(=O)(OC)OC(=CCl)c1cc(Cl)c(Cl)cc1Cl\n</pre>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      Most deep learning models can process a batch of multiple samples all at once.  You can use\n      <code>\n       iterbatches()\n      </code>\n      to iterate over batches of samples.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[6]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="k">for</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">ids</span> <span class="ow">in</span> <span class="n">test_dataset</span><span class="o">.</span><span class="n">iterbatches</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>\n    <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll font-mono">(50, 1)\n(50, 1)\n(13, 1)\n</pre>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      <code>\n       iterbatches()\n      </code>\n      has other features that are useful when training models.  For example,\n      <code>\n       iterbatches(batch_size=100, epochs=10, deterministic=False)\n      </code>\n      will iterate over the complete dataset ten times, each time with the samples in a different random order.\n     </p>\n     <p>\n      Datasets can also expose data using the standard interfaces for TensorFlow and PyTorch.  To get a\n      <code>\n       tensorflow.data.Dataset\n      </code>\n      , call\n      <code>\n       make_tf_dataset()\n      </code>\n      .  To get a\n      <code>\n       torch.utils.data.IterableDataset\n      </code>\n      , call\n      <code>\n       make_pytorch_dataset()\n      </code>\n      .  See the API documentation for more details.\n     </p>\n     <p>\n      The final way of accessing data is\n      <code>\n       to_dataframe()\n      </code>\n      .  This copies the data into a Pandas\n      <code>\n       DataFrame\n      </code>\n      .  This requires storing all the data in memory at once, so you should only use it with small datasets.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[7]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="n">test_dataset</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child jp-OutputArea-executeResult">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n      Out[7]:\n     </div>\n     <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">\n      <div>\n       <style scoped="">\n        .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n       </style>\n       <table border="1" class="dataframe">\n        <thead>\n         <tr style="text-align: right;">\n          <th>\n          </th>\n          <th>\n           X\n          </th>\n          <th>\n           y\n          </th>\n          <th>\n           w\n          </th>\n          <th>\n           ids\n          </th>\n         </tr>\n        </thead>\n        <tbody>\n         <tr>\n          <th>\n           0\n          </th>\n          <td>\n           &lt;deepchem.feat.mol_graphs.ConvMol object at 0x...\n          </td>\n          <td>\n           -1.706541\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           C1c2ccccc2c3ccc4ccccc4c13\n          </td>\n         </tr>\n         <tr>\n          <th>\n           1\n          </th>\n          <td>\n           &lt;deepchem.feat.mol_graphs.ConvMol object at 0x...\n          </td>\n          <td>\n           0.291116\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           COc1ccccc1Cl\n          </td>\n         </tr>\n         <tr>\n          <th>\n           2\n          </th>\n          <td>\n           &lt;deepchem.feat.mol_graphs.ConvMol object at 0x...\n          </td>\n          <td>\n           -1.427248\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           COP(=S)(OC)Oc1cc(Cl)c(Br)cc1Cl\n          </td>\n         </tr>\n         <tr>\n          <th>\n           3\n          </th>\n          <td>\n           &lt;deepchem.feat.mol_graphs.ConvMol object at 0x...\n          </td>\n          <td>\n           -0.925466\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           ClC(Cl)CC(=O)NC2=C(Cl)C(=O)c1ccccc1C2=O\n          </td>\n         </tr>\n         <tr>\n          <th>\n           4\n          </th>\n          <td>\n           &lt;deepchem.feat.mol_graphs.ConvMol object at 0x...\n          </td>\n          <td>\n           -1.952698\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           ClC(Cl)C(c1ccc(Cl)cc1)c2ccc(Cl)cc2\n          </td>\n         </tr>\n         <tr>\n          <th>\n           ...\n          </th>\n          <td>\n           ...\n          </td>\n          <td>\n           ...\n          </td>\n          <td>\n           ...\n          </td>\n          <td>\n           ...\n          </td>\n         </tr>\n         <tr>\n          <th>\n           108\n          </th>\n          <td>\n           &lt;deepchem.feat.mol_graphs.ConvMol object at 0x...\n          </td>\n          <td>\n           0.646150\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           FC(F)(F)C(Cl)Br\n          </td>\n         </tr>\n         <tr>\n          <th>\n           109\n          </th>\n          <td>\n           &lt;deepchem.feat.mol_graphs.ConvMol object at 0x...\n          </td>\n          <td>\n           1.505805\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           CNC(=O)ON=C(SC)C(=O)N(C)C\n          </td>\n         </tr>\n         <tr>\n          <th>\n           110\n          </th>\n          <td>\n           &lt;deepchem.feat.mol_graphs.ConvMol object at 0x...\n          </td>\n          <td>\n           -0.007586\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           CCSCCSP(=S)(OC)OC\n          </td>\n         </tr>\n         <tr>\n          <th>\n           111\n          </th>\n          <td>\n           &lt;deepchem.feat.mol_graphs.ConvMol object at 0x...\n          </td>\n          <td>\n           -0.049716\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           CCC(C)C\n          </td>\n         </tr>\n         <tr>\n          <th>\n           112\n          </th>\n          <td>\n           &lt;deepchem.feat.mol_graphs.ConvMol object at 0x...\n          </td>\n          <td>\n           -0.684990\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           COP(=O)(OC)OC(=CCl)c1cc(Cl)c(Cl)cc1Cl\n          </td>\n         </tr>\n        </tbody>\n       </table>\n       <p>\n        113 rows \xd7 4 columns\n       </p>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h1>\n      Creating Datasets\n      <a class="anchor-link" href="#Creating-Datasets">\n       \xb6\n      </a>\n     </h1>\n     <p>\n      Now let\'s talk about how you can create your own datasets.  Creating a\n      <code>\n       NumpyDataset\n      </code>\n      is very simple: just pass the arrays containing the data to the constructor.  Let\'s create some random arrays, then wrap them in a NumpyDataset.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[8]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>\n\n<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>\n<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>\n<span class="n">dataset</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">NumpyDataset</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>\n<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll font-mono">&lt;NumpyDataset X.shape: (10, 5), y.shape: (10, 2), w.shape: (10, 1), ids: [0 1 2 3 4 5 6 7 8 9], task_names: [0 1]&gt;\n</pre>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      Notice that we did not specify weights or IDs.  These are optional, as is\n      <code>\n       y\n      </code>\n      for that matter.  Only\n      <code>\n       X\n      </code>\n      is required.  Since we left them out, it automatically built\n      <code>\n       w\n      </code>\n      and\n      <code>\n       ids\n      </code>\n      arrays for us, setting all weights to 1 and setting the IDs to integer indices.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[9]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child jp-OutputArea-executeResult">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n      Out[9]:\n     </div>\n     <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">\n      <div>\n       <style scoped="">\n        .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n       </style>\n       <table border="1" class="dataframe">\n        <thead>\n         <tr style="text-align: right;">\n          <th>\n          </th>\n          <th>\n           X1\n          </th>\n          <th>\n           X2\n          </th>\n          <th>\n           X3\n          </th>\n          <th>\n           X4\n          </th>\n          <th>\n           X5\n          </th>\n          <th>\n           y1\n          </th>\n          <th>\n           y2\n          </th>\n          <th>\n           w\n          </th>\n          <th>\n           ids\n          </th>\n         </tr>\n        </thead>\n        <tbody>\n         <tr>\n          <th>\n           0\n          </th>\n          <td>\n           0.547330\n          </td>\n          <td>\n           0.919941\n          </td>\n          <td>\n           0.289138\n          </td>\n          <td>\n           0.431806\n          </td>\n          <td>\n           0.776672\n          </td>\n          <td>\n           0.532579\n          </td>\n          <td>\n           0.443258\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           0\n          </td>\n         </tr>\n         <tr>\n          <th>\n           1\n          </th>\n          <td>\n           0.980867\n          </td>\n          <td>\n           0.642487\n          </td>\n          <td>\n           0.460640\n          </td>\n          <td>\n           0.500153\n          </td>\n          <td>\n           0.014848\n          </td>\n          <td>\n           0.678259\n          </td>\n          <td>\n           0.274029\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           1\n          </td>\n         </tr>\n         <tr>\n          <th>\n           2\n          </th>\n          <td>\n           0.953254\n          </td>\n          <td>\n           0.704446\n          </td>\n          <td>\n           0.857458\n          </td>\n          <td>\n           0.378372\n          </td>\n          <td>\n           0.705789\n          </td>\n          <td>\n           0.704786\n          </td>\n          <td>\n           0.901080\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           2\n          </td>\n         </tr>\n         <tr>\n          <th>\n           3\n          </th>\n          <td>\n           0.904970\n          </td>\n          <td>\n           0.729710\n          </td>\n          <td>\n           0.304247\n          </td>\n          <td>\n           0.861546\n          </td>\n          <td>\n           0.917029\n          </td>\n          <td>\n           0.121747\n          </td>\n          <td>\n           0.758845\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           3\n          </td>\n         </tr>\n         <tr>\n          <th>\n           4\n          </th>\n          <td>\n           0.464144\n          </td>\n          <td>\n           0.059168\n          </td>\n          <td>\n           0.600405\n          </td>\n          <td>\n           0.880529\n          </td>\n          <td>\n           0.688043\n          </td>\n          <td>\n           0.595495\n          </td>\n          <td>\n           0.719861\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           4\n          </td>\n         </tr>\n         <tr>\n          <th>\n           5\n          </th>\n          <td>\n           0.820482\n          </td>\n          <td>\n           0.139002\n          </td>\n          <td>\n           0.627421\n          </td>\n          <td>\n           0.129399\n          </td>\n          <td>\n           0.920024\n          </td>\n          <td>\n           0.634030\n          </td>\n          <td>\n           0.464525\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           5\n          </td>\n         </tr>\n         <tr>\n          <th>\n           6\n          </th>\n          <td>\n           0.113727\n          </td>\n          <td>\n           0.551801\n          </td>\n          <td>\n           0.536189\n          </td>\n          <td>\n           0.066091\n          </td>\n          <td>\n           0.311320\n          </td>\n          <td>\n           0.699331\n          </td>\n          <td>\n           0.171532\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           6\n          </td>\n         </tr>\n         <tr>\n          <th>\n           7\n          </th>\n          <td>\n           0.516131\n          </td>\n          <td>\n           0.918903\n          </td>\n          <td>\n           0.429036\n          </td>\n          <td>\n           0.844973\n          </td>\n          <td>\n           0.639367\n          </td>\n          <td>\n           0.464089\n          </td>\n          <td>\n           0.337989\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           7\n          </td>\n         </tr>\n         <tr>\n          <th>\n           8\n          </th>\n          <td>\n           0.809393\n          </td>\n          <td>\n           0.201450\n          </td>\n          <td>\n           0.821420\n          </td>\n          <td>\n           0.841390\n          </td>\n          <td>\n           0.100026\n          </td>\n          <td>\n           0.230462\n          </td>\n          <td>\n           0.376151\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           8\n          </td>\n         </tr>\n         <tr>\n          <th>\n           9\n          </th>\n          <td>\n           0.076750\n          </td>\n          <td>\n           0.389277\n          </td>\n          <td>\n           0.350371\n          </td>\n          <td>\n           0.291806\n          </td>\n          <td>\n           0.127522\n          </td>\n          <td>\n           0.544606\n          </td>\n          <td>\n           0.306578\n          </td>\n          <td>\n           1.0\n          </td>\n          <td>\n           9\n          </td>\n         </tr>\n        </tbody>\n       </table>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      What about creating a DiskDataset?  If you have the data in NumPy arrays, you can call\n      <code>\n       DiskDataset.from_numpy()\n      </code>\n      to save it to disk.  Since this is just a tutorial, we will save it to a temporary directory.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[10]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll font-mono"><span></span><span class="kn">import</span> <span class="nn">tempfile</span>\n\n<span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">data_dir</span><span class="p">:</span>\n    <span class="n">disk_dataset</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DiskDataset</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="n">data_dir</span><span class="p">)</span>\n    <span class="nb">print</span><span class="p">(</span><span class="n">disk_dataset</span><span class="p">)</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll font-mono">&lt;DiskDataset X.shape: (10, 5), y.shape: (10, 2), w.shape: (10, 1), ids: [0 1 2 3 4 5 6 7 8 9], task_names: [0 1]&gt;\n</pre>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      What about larger datasets that can\'t fit in memory?  What if you have some huge files on disk containing data on hundreds of millions of molecules?  The process for creating a DiskDataset from them is slightly more involved.  Fortunately, DeepChem\'s\n      <code>\n       DataLoader\n      </code>\n      framework can automate most of the work for you.  That is a larger subject, so we will return to it in a later tutorial.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h1>\n      Congratulations! Time to join the Community!\n      <a class="anchor-link" href="#Congratulations!-Time-to-join-the-Community!">\n       \xb6\n      </a>\n     </h1>\n     <p>\n      Congratulations on completing this tutorial notebook! If you enjoyed working through the tutorial, and want to continue working with DeepChem, we encourage you to finish the rest of the tutorials in this series. You can also help the DeepChem community in the following ways:\n     </p>\n     <h2>\n      Star DeepChem on\n      <a href="https://github.com/deepchem/deepchem">\n       GitHub\n      </a>\n      <a class="anchor-link" href="#Star-DeepChem-on-GitHub">\n       \xb6\n      </a>\n     </h2>\n     <p>\n      This helps build awareness of the DeepChem project and the tools for open source drug discovery that we\'re trying to build.\n     </p>\n     <h2>\n      Join the DeepChem Gitter\n      <a class="anchor-link" href="#Join-the-DeepChem-Gitter">\n       \xb6\n      </a>\n     </h2>\n     <p>\n      The DeepChem\n      <a href="https://gitter.im/deepchem/Lobby">\n       Gitter\n      </a>\n      hosts a number of scientists, developers, and enthusiasts interested in deep learning for the life sciences. Join the conversation!\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n</main>\n'},c=a(7294),d=a(7466),o=a.n(d);let i=()=>((0,c.useEffect)(()=>{var n,t;null===(n=document.getElementsByClassName("scroll-nav")[0])||void 0===n||n.remove();let a=document.querySelector(".notebook"),s=document.querySelector(".notebook");s&&a&&o().init(a,{sections:"h1, h2",insertTarget:s,insertLocation:"after"}),null==MathJax||null===(t=MathJax.Hub)||void 0===t||t.Queue(["Typeset",MathJax.Hub])},[]),(0,s.jsx)("div",{className:"overflow-x-scroll",dangerouslySetInnerHTML:{__html:"".concat(l.html," ").concat(p.Z)}}));i.Layout=e.Z;var r=i}},function(n){n.O(0,[2443,9774,2888,179],function(){return n(n.s=921)}),_N_E=n.O()}]);