(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7083],{8094:function(n,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tutorials/interactive-model-evaluation-with-trident-chemwidgets",function(){return a(712)}])},712:function(n,s,a){"use strict";a.r(s),a.d(s,{default:function(){return c}});var p=a(5893),e=a(1618),t=a(6485),l={html:'<main>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h1>\n      Interactive model evaluation with Trident Chemwidgets\n      <a class="anchor-link" href="#Interactive-model-evaluation-with-Trident-Chemwidgets">\n       \xb6\n      </a>\n     </h1>\n     <p>\n      In this tutorial we\'ll build on the\n      <a href="https://github.com/deepchem/deepchem/blob/master/examples/tutorials/Introduction_to_Graph_Convolutions.ipynb">\n       <em>\n        Introduction to Graph Covolutions\n       </em>\n       tutorial\n      </a>\n      to show how you can use the\n      <a href="https://github.com/tridentbio/trident-chemwidgets">\n       Trident Chemwidgets\n      </a>\n      (TCW) package to interact with and test the model you\'ve trained.\n     </p>\n     <p>\n      Evaluating models on new data, including corner cases, is a critical step toward model deployment. However, generating new molecules to test in an interactive way is rarely straightforward. TCW provides several tools to help subset larger datasets and draw new molecules to test against your models. You can find the full documentation for the Trident Chemwidgets library\n      <a href="https://www.trident.bio/trident-chemwidgets/html/index.html">\n       here\n      </a>\n      .\n     </p>\n     <h2>\n      Colab\n      <a class="anchor-link" href="#Colab">\n       \xb6\n      </a>\n     </h2>\n     <p>\n      This tutorial and the rest in this sequence are designed to be done in Google colab. If you\'d like to open this notebook in colab, you can use the following link.\n     </p>\n     <p>\n      <a href="https://colab.research.google.com/github/deepchem/deepchem/blob/master/examples/tutorials/Interactive_model_evaluation_with_Trident_Chemwidgets.ipynb">\n       <img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/>\n      </a>\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h1>\n      Installing the prerequisites\n      <a class="anchor-link" href="#Installing-the-prerequisites">\n       \xb6\n      </a>\n     </h1>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[\xa0]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="o">!</span>pip install tensorflow deepchem trident-chemwidgets seaborn\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      For this tutorial, you\'ll need Trident Chemwidgets version 0.2.0 or greater. We can check the installed version with the following command:\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[1]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="kn">import</span> <span class="nn">trident_chemwidgets</span> <span class="k">as</span> <span class="nn">tcw</span>\n<span class="nb">print</span><span class="p">(</span><span class="n">tcw</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll">0.2.1\n</pre>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      Throughout this tutorial, we\'ll use the convention\n      <code>\n       tcw\n      </code>\n      to call the classes from the Trident Chemwidgets package.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h1>\n      Exploring the data\n      <a class="anchor-link" href="#Exploring-the-data">\n       \xb6\n      </a>\n     </h1>\n     <p>\n      We\'ll start out by loading the Tox21 dataset and extracting the predefined train, validation, and test splits.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[2]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="kn">import</span> <span class="nn">deepchem</span> <span class="k">as</span> <span class="nn">dc</span>\n\n<span class="n">tasks</span><span class="p">,</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">transformers</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">molnet</span><span class="o">.</span><span class="n">load_tox21</span><span class="p">(</span><span class="n">featurizer</span><span class="o">=</span><span class="s1">\'GraphConv\'</span><span class="p">)</span>\n<span class="n">train_dataset</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">,</span> <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">datasets</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      We can then use RDKit to calculate some additional features for each of the training examples. Specifically, we\'ll compute the\n      <a href="https://en.wikipedia.org/wiki/Partition_coefficient">\n       logP\n      </a>\n      and\n      <a href="https://en.wikipedia.org/wiki/Molecular_mass">\n       molecular weight\n      </a>\n      of each molecule and return this new data in a dataframe.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[3]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="kn">import</span> <span class="nn">rdkit.Chem</span> <span class="k">as</span> <span class="nn">Chem</span>\n<span class="kn">from</span> <span class="nn">rdkit.Chem.Crippen</span> <span class="kn">import</span> <span class="n">MolLogP</span>\n<span class="kn">from</span> <span class="nn">rdkit.Chem.Descriptors</span> <span class="kn">import</span> <span class="n">MolWt</span>\n<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>\n\n<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>\n\n<span class="k">for</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">split</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="p">[</span><span class="s1">\'train\'</span><span class="p">,</span> <span class="s1">\'valid\'</span><span class="p">,</span> <span class="s1">\'test\'</span><span class="p">]):</span>\n    <span class="k">for</span> <span class="n">smiles</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">ids</span><span class="p">:</span>\n        <span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>\n        <span class="n">logp</span> <span class="o">=</span> <span class="n">MolLogP</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>\n        <span class="n">mwt</span> <span class="o">=</span> <span class="n">MolWt</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>\n        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>\n            <span class="s1">\'smiles\'</span><span class="p">:</span> <span class="n">smiles</span><span class="p">,</span>\n            <span class="s1">\'logp\'</span><span class="p">:</span> <span class="n">logp</span><span class="p">,</span>\n            <span class="s1">\'mwt\'</span><span class="p">:</span> <span class="n">mwt</span><span class="p">,</span>\n            <span class="s1">\'split\'</span><span class="p">:</span> <span class="n">split</span>\n        <span class="p">})</span>\n        \n<span class="n">mol_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>\n\n<span class="n">mol_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">\n      <pre class="overflow-x-scroll">[15:36:55] WARNING: not removing hydrogen atom without neighbors\n</pre>\n     </div>\n    </div>\n    <div class="jp-OutputArea-child jp-OutputArea-executeResult">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n      Out[3]:\n     </div>\n     <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">\n      <div>\n       <style scoped="">\n        .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n       </style>\n       <table border="1" class="dataframe">\n        <thead>\n         <tr style="text-align: right;">\n          <th>\n          </th>\n          <th>\n           smiles\n          </th>\n          <th>\n           logp\n          </th>\n          <th>\n           mwt\n          </th>\n          <th>\n           split\n          </th>\n         </tr>\n        </thead>\n        <tbody>\n         <tr>\n          <th>\n           0\n          </th>\n          <td>\n           CC(O)(P(=O)(O)O)P(=O)(O)O\n          </td>\n          <td>\n           -0.9922\n          </td>\n          <td>\n           206.027\n          </td>\n          <td>\n           train\n          </td>\n         </tr>\n         <tr>\n          <th>\n           1\n          </th>\n          <td>\n           CC(C)(C)OOC(C)(C)CCC(C)(C)OOC(C)(C)C\n          </td>\n          <td>\n           4.8172\n          </td>\n          <td>\n           290.444\n          </td>\n          <td>\n           train\n          </td>\n         </tr>\n         <tr>\n          <th>\n           2\n          </th>\n          <td>\n           OC[C@H](O)[C@@H](O)[C@H](O)CO\n          </td>\n          <td>\n           -2.9463\n          </td>\n          <td>\n           152.146\n          </td>\n          <td>\n           train\n          </td>\n         </tr>\n         <tr>\n          <th>\n           3\n          </th>\n          <td>\n           CCCCCCCC(=O)[O-].CCCCCCCC(=O)[O-].[Zn+2]\n          </td>\n          <td>\n           2.1911\n          </td>\n          <td>\n           351.802\n          </td>\n          <td>\n           train\n          </td>\n         </tr>\n         <tr>\n          <th>\n           4\n          </th>\n          <td>\n           CC(C)COC(=O)C(C)C\n          </td>\n          <td>\n           1.8416\n          </td>\n          <td>\n           144.214\n          </td>\n          <td>\n           train\n          </td>\n         </tr>\n        </tbody>\n       </table>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h2>\n      One-dimensional distributions\n      <a class="anchor-link" href="#One-dimensional-distributions">\n       \xb6\n      </a>\n     </h2>\n     <p>\n      We can examine one-dimensional distributions using a histogram. Unlike histograms from static plotting libraries like Matplotlib or Seaborn, the TCW Histogram provides interactive functionality. TCW enables subsetting of the data, plotting chemical structures in a gallery next to the plot, and saving a reference to the subset portion of the dataframe. Unfortunately, this interactivity comes at the price of portability, so we have included screenshots for this tutorial in addition to providing the code to generate the interactive visuals. If you run this tutorial yourself (either locally or on Colab), you\'ll be able to display and interact with full demo plots.\n     </p>\n     <p>\n      In the plot below, you can see the histogram of the molecular weight distribution from the combined dataset on the left. If you click and drag within plot area in the live widget, you can subset a portion of the distribution for further examination. The background of the selected portion will turn gray and the selected data points will be shown in teal within the bars of the plot. The x axis of the Histogram widget is compatible with either numeric or date data types, which makes it a convenient choice for splitting your ML datasets based on a property or the date the experimental data were collected.\n     </p>\n     <p>\n      <img alt="Histogram example" src="./assets/trident_chemwidgets_data/Histogram.png" width="1000"/>\n     </p>\n     <p>\n      To generate an interactive example of the widget, run the next cell:\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[4]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="n">hist</span> <span class="o">=</span> <span class="n">tcw</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">mol_data</span><span class="p">,</span> <span class="n">smiles</span><span class="o">=</span><span class="s1">\'smiles\'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">\'mwt\'</span><span class="p">)</span>\n<span class="n">hist</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll">Histogram(data={\'points\': [{\'smiles\': \'CC(O)(P(=O)(O)O)P(=O)(O)O\', \'x\': 206.027, \'index\': 0}, {\'smiles\': \'CC(C…</pre>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      If you select subset of the data by clicking and dragging, you can view the selected structures in the gallery to the right by pressing the\n      <code>\n       SHOW STRUCTURES\n      </code>\n      button beneath the plot. You can extract this subset of the original dataframe by pressing\n      <code>\n       SAVE SELECTION\n      </code>\n      and accessing the\n      <code>\n       hist.selection\n      </code>\n      property as shown in the next cell. This workflow is convenient for applications like data splitting based on a single dimension.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[5]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="n">hist</span><span class="o">.</span><span class="n">selection</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child jp-OutputArea-executeResult">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n      Out[5]:\n     </div>\n     <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">\n      <div>\n       <style scoped="">\n        .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n       </style>\n       <table border="1" class="dataframe">\n        <thead>\n         <tr style="text-align: right;">\n          <th>\n          </th>\n          <th>\n           smiles\n          </th>\n          <th>\n           logp\n          </th>\n          <th>\n           mwt\n          </th>\n          <th>\n           split\n          </th>\n         </tr>\n        </thead>\n        <tbody>\n        </tbody>\n       </table>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h2>\n      Two- or three-dimensional distributions\n      <a class="anchor-link" href="#Two--or-three-dimensional-distributions">\n       \xb6\n      </a>\n     </h2>\n     <p>\n      In addition to histograms, TCW also has provides a class for scatter plots. The Scatter class is useful when comparing two or three dimensions or your data. As of v0.2.0, TCW Scatter supports the use of the x and y axes as well as the color of each point (\n      <code>\n       hue\n      </code>\n      keyword) to represent either continuous or discrete variables. Just like in the Histogram example, you can click and drag within the plot area to subset along the x and y axes. The Scatter widget also supports dates along the x, y, and hue axes.\n     </p>\n     <p>\n      In the image below, we have selected a portion of dataset with large molecular weight values, but minimal training examples (displayed points in orange), to demonstrate how the Scatter widget can be useful for outlier identification. In addition to selection by bounding box, you can also hover over individual points to display a drawing of the underlying structure.\n     </p>\n     <p>\n      <img alt="Scatter example" src="./assets/trident_chemwidgets_data/Scatter.png" width="1000"/>\n     </p>\n     <p>\n      To generate an interactive example of the widget, run the next cell:\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[6]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="n">scatter</span> <span class="o">=</span> <span class="n">tcw</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">mol_data</span><span class="p">,</span> <span class="n">smiles</span><span class="o">=</span><span class="s1">\'smiles\'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">\'mwt\'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">\'logp\'</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">\'split\'</span><span class="p">)</span>\n<span class="n">scatter</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll">Scatter(data={\'points\': [{\'smiles\': \'CC(O)(P(=O)(O)O)P(=O)(O)O\', \'x\': 206.027, \'y\': -0.9922000000000002, \'hue\'…</pre>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      If you select subset of the data by clicking and dragging, you can view the selected structures in the gallery to the right by pressing the\n      <code>\n       SHOW STRUCTURES\n      </code>\n      button beneath the plot. You can extract this subset of the original dataframe by pressing\n      <code>\n       SAVE SELECTION\n      </code>\n      and accessing the\n      <code>\n       scatter.selection\n      </code>\n      property as shown in the next cell.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[7]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="n">scatter</span><span class="o">.</span><span class="n">selection</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child jp-OutputArea-executeResult">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n      Out[7]:\n     </div>\n     <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">\n      <div>\n       <style scoped="">\n        .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n       </style>\n       <table border="1" class="dataframe">\n        <thead>\n         <tr style="text-align: right;">\n          <th>\n          </th>\n          <th>\n           smiles\n          </th>\n          <th>\n           logp\n          </th>\n          <th>\n           mwt\n          </th>\n          <th>\n           split\n          </th>\n         </tr>\n        </thead>\n        <tbody>\n        </tbody>\n       </table>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h1>\n      Training a GraphConvModel\n      <a class="anchor-link" href="#Training-a-GraphConvModel">\n       \xb6\n      </a>\n     </h1>\n     <p>\n      Now that we\'ve had a look at the training data, we can train a GraphConvModel to predict the 12 Tox21 classes. We\'ll replicate the training procedure exactly from the\n      <a href="https://github.com/deepchem/deepchem/blob/master/examples/tutorials/Introduction_to_Graph_Convolutions.ipynb">\n       <em>\n        Introduction to Graph Covolutions\n       </em>\n       tutorial\n      </a>\n      . We\'ll train for 50 epochs, just as in the original tutorial.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[8]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="c1"># The next line filters tensorflow warnings relevant to memory consumption.</span>\n<span class="c1"># To see these warnings, comment the next line.</span>\n<span class="kn">import</span> <span class="nn">warnings</span><span class="p">;</span> <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">\'ignore\'</span><span class="p">)</span>\n\n<span class="c1"># Now we\'ll set the tensorflow seed to make sure the results of this notebook are reproducible</span>\n<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span><span class="p">;</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>\n\n<span class="n">n_tasks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span>\n<span class="n">model</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">GraphConvModel</span><span class="p">(</span><span class="n">n_tasks</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">\'classification\'</span><span class="p">)</span>\n<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">nb_epoch</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr" tabindex="0">\n      <pre class="overflow-x-scroll">2022-06-29 15:37:03.915828: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA\nTo enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n</pre>\n     </div>\n    </div>\n    <div class="jp-OutputArea-child jp-OutputArea-executeResult">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n      Out[8]:\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll">0.2661594772338867</pre>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      Now that we have a trained model, we can check AUROC values for the training and test datasets:\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[9]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="n">metric</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">Metric</span><span class="p">(</span><span class="n">dc</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">roc_auc_score</span><span class="p">)</span>\n<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">\'Training set score: </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span> <span class="p">[</span><span class="n">metric</span><span class="p">],</span> <span class="n">transformers</span><span class="p">)[</span><span class="s2">"roc_auc_score"</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">\'</span><span class="p">)</span>\n<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">\'Test set score: </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="p">[</span><span class="n">metric</span><span class="p">],</span> <span class="n">transformers</span><span class="p">)[</span><span class="s2">"roc_auc_score"</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">\'</span><span class="p">)</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll">Training set score: 0.97\nTest set score: 0.68\n</pre>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      Just as in the original tutorial, we see that the model performs reasonably well on the predefined train/test splits. Now we\'ll use this model to evaluate compounds that are outside the training distribution, just as we might in a real-world drug discovery scenario.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h1>\n      Evaluating the model on new data\n      <a class="anchor-link" href="#Evaluating-the-model-on-new-data">\n       \xb6\n      </a>\n     </h1>\n     <p>\n      One of the challenging first steps toward deploying an ML model in production is evaluating it on new data. Here, new data refers to both data outside the initial train/val/test distributions and also data that may not be already processed for use with the model.\n     </p>\n     <p>\n      We can use the JSME widget provided by TCW to quickly test our model again some molecules of interest. We\'ll start with a known therapeutic molecule: ibuprofen. We can see that ibuprofen is not included in any of the datasets that we have evaluated our model against so far:\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[10]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Ibuprofen structure in Tox21 dataset: </span><span class="si">{</span><span class="s1">\'CC(C)CC1=CC=C(C=C1)C(C)C(=O)O\'</span> <span class="ow">in</span> <span class="n">mol_data</span><span class="p">[</span><span class="s1">\'smiles\'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll">Ibuprofen structure in Tox21 dataset: False\n</pre>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      To simulate a drug discovery application, let\'s say you\'re a chemist tasked with identifying potential new therapeutics derived from ibuprofen. Ideally, the molecules you test would have limited toxicity. You\'ve just developed the model above to predict the tox outcomes from Tox21 data and now you want to use it to do some first-pass screening of your derivatives. The standard workflow for a task like this might include drawing the molecules in a program like ChemDraw, exporting to SMILES format, importing into the notebook, then prepping the data and running it through your model.\n     </p>\n     <p>\n      With TCW, we can shortcut the first few steps of that workflow by using the\n      <a href="https://jsme-editor.github.io/help.html">\n       JSME\n      </a>\n      widget to draw molecules and convert to SMILES directly in the notebook. We can even use the\n      <code>\n       base_smiles\n      </code>\n      argument to specify a base molecular structure, which is great for generating derivatives. Here we\'ll set the base_smiles value to\n      <code>\n       \'CC(C)CC1=CC=C(C=C1)C(C)C(=O)O\'\n      </code>\n      , the SMILES string for ibuprofen. Below is a screenshot using JSME to generate a few derivative molecules to test against our toxicity model.\n     </p>\n     <p>\n      <img alt="JSME example" src="./assets/trident_chemwidgets_data/JSME.png" width="1000"/>\n     </p>\n     <p>\n      To generate your own set of derivatives, run the cell below. To add a SMILES string to the saved set, click the\n      <code>\n       ADD TO SMILES LIST\n      </code>\n      button below the interface. If you want to regenerate the original base molecule, in this case ibuprofen, click the\n      <code>\n       RESET TO BASE SMILES\n      </code>\n      button below the interface. By using this button, it\'s easy to generate distinct derivatives from a shared starting structure.  Go ahead and create some ibuprofen derivatives to test against the tox model:\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[11]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="n">jsme</span> <span class="o">=</span> <span class="n">tcw</span><span class="o">.</span><span class="n">JSME</span><span class="p">(</span><span class="n">base_smiles</span><span class="o">=</span><span class="s1">\'CC(C)CC1=CC=C(C=C1)C(C)C(=O)O\'</span><span class="p">)</span>\n<span class="n">jsme</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll">JSME(base_smiles=\'CC(C)CC1=CC=C(C=C1)C(C)C(=O)O\')</pre>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      You can access the smiles using the\n      <code>\n       jsme.smiles\n      </code>\n      property. This call will return a list of the SMILES strings that have been added to the SMILES list of the widget (the ones shown in the molecule gallery to the right of the JSME interface).\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[12]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="nb">print</span><span class="p">(</span><span class="n">jsme</span><span class="o">.</span><span class="n">smiles</span><span class="p">)</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll">[]\n</pre>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      To ensure the rest of this notebook runs correctly, the following cell sets the new test SMILES set to the ones from the screenshot above in the case that you have not defined your own set using the widget. Otherwise, it will use the molecules you have drawn.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[13]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="c1"># This cell will provide a preset list of SMILES strings in case you did not create your own.</span>\n<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">jsme</span><span class="o">.</span><span class="n">smiles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>\n    <span class="n">drawn_smiles</span> <span class="o">=</span> <span class="n">jsme</span><span class="o">.</span><span class="n">smiles</span>\n<span class="k">else</span><span class="p">:</span>\n    <span class="n">drawn_smiles</span> <span class="o">=</span> <span class="p">[</span>\n        <span class="s1">\'CC(C)Cc1ccc(C(C)C(=O)O)cc1\'</span><span class="p">,</span>\n        <span class="s1">\'CC(C)C(S)c1ccc(C(C)C(=O)O)cc1\'</span><span class="p">,</span>\n        <span class="s1">\'CCSC(c1ccc(C(C)C(=O)O)cc1)C(C)CC\'</span><span class="p">,</span>\n        <span class="s1">\'CCSC(c1ccc(C(C)C(=O)O)cc1)C(C)C(=O)O\'</span><span class="p">,</span>\n        <span class="s1">\'CC(C(=O)O)c1ccc(C(S)C(C)C(=O)O)cc1\'</span>\n    <span class="p">]</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      Next we have to create a dataset that is compatible with our model to test these new molecules.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[14]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="n">featurizer</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">feat</span><span class="o">.</span><span class="n">ConvMolFeaturizer</span><span class="p">()</span>\n<span class="n">loader</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">InMemoryLoader</span><span class="p">(</span><span class="n">tasks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">train_dataset</span><span class="o">.</span><span class="n">tasks</span><span class="p">),</span> <span class="n">featurizer</span><span class="o">=</span><span class="n">featurizer</span><span class="p">)</span>\n<span class="n">dataset</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="n">drawn_smiles</span><span class="p">,</span> <span class="n">shard_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      Finally, we can generate our predictions of positive results here and plot them.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[15]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span>\n\n<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>\n<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child jp-OutputArea-executeResult">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n      Out[15]:\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll">&lt;AxesSubplot:&gt;</pre>\n     </div>\n    </div>\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">\n      <img alt="No description has been provided for this image" class="jp-needs-light-background" src="data:image/png;base64,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\n"/>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      Now we can get the predicted most toxic compound/assay result for further inspection. Below we extract the highest predicted positive hit (most toxic) and display the assay name, SMILES string, and an image of the structure.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[16]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>\n\n<span class="n">mol_idx</span><span class="p">,</span> <span class="n">assay_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">predictions</span><span class="o">.</span><span class="n">argmax</span><span class="p">(),</span> <span class="n">predictions</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>\n<span class="n">smiles</span> <span class="o">=</span> <span class="n">drawn_smiles</span><span class="p">[</span><span class="n">mol_idx</span><span class="p">]</span>\n\n<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">\'Most toxic result (predicted): </span><span class="si">{</span><span class="n">train_dataset</span><span class="o">.</span><span class="n">tasks</span><span class="p">[</span><span class="n">assay_idx</span><span class="p">]</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">smiles</span><span class="si">}</span><span class="s1">\'</span><span class="p">)</span>\n<span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>\n<span class="n">mol</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll">Most toxic result (predicted): NR-ER, CC(C)Cc1ccc(C(C)C(=O)O)cc1\n</pre>\n     </div>\n    </div>\n    <div class="jp-OutputArea-child jp-OutputArea-executeResult">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n      Out[16]:\n     </div>\n     <div class="jp-RenderedImage jp-OutputArea-output jp-OutputArea-executeResult" tabindex="0">\n      <img alt="No description has been provided for this image" class="" src="data:image/png;base64,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\n"/>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h1>\n      Interpreting the model\'s predictions\n      <a class="anchor-link" href="#Interpreting-the-model\'s-predictions">\n       \xb6\n      </a>\n     </h1>\n     <p>\n      Often predictions alone are insufficient to decide whether to move forward with costly experiments. We might also want some metric or metrics that allow us to interpret the model\'s output.\n     </p>\n     <p>\n      Building on the tutorial\n      <a href="https://github.com/deepchem/deepchem/blob/master/examples/tutorials/Atomic_Contributions_for_Molecules.ipynb">\n       Calculating Atomic Contributions for Molecules Based on a Graph Convolutional QSAR Model\n      </a>\n      , we can calculate the relative contribution of each atom in a molecule to the predicted output value. This attribution strategy enables us to determine whether the molecular features that a chemist may identify as important and those most affecting the predictions are in alignment. If the chemist\'s interpretation and the model\'s interpretation metrics are consistent, that may indicate that the model is a good fit for the task at hand. However, the inverse is not necessarily true either. A model may have the capacity to make accurate predictions that a trained chemist cannot fully understand. This is just one tool in a machine learning practitioner\'s toolbox.\n     </p>\n     <p>\n      We\'ll start by using the built-in\n      <code>\n       per_atom_fragmentation\n      </code>\n      argument for the\n      <code>\n       ConvMolFeaturizer\n      </code>\n      . This will generate a list of ConvMol objects that have each had a single atom removed.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[17]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="n">featurizer</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">feat</span><span class="o">.</span><span class="n">ConvMolFeaturizer</span><span class="p">(</span><span class="n">per_atom_fragmentation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>\n<span class="n">mol_list</span> <span class="o">=</span> <span class="n">featurizer</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>\n<span class="n">loader</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">InMemoryLoader</span><span class="p">(</span><span class="n">tasks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">train_dataset</span><span class="o">.</span><span class="n">tasks</span><span class="p">),</span>\n                                <span class="n">featurizer</span><span class="o">=</span><span class="n">dc</span><span class="o">.</span><span class="n">feat</span><span class="o">.</span><span class="n">DummyFeaturizer</span><span class="p">())</span>\n<span class="n">dataset</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="n">mol_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shard_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      We can then run these predictions through the model and retrieve the predicted values for the molecule and assay specified in the last section.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[18]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="n">full_molecule_prediction</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">mol_idx</span><span class="p">,</span> <span class="n">assay_idx</span><span class="p">]</span>\n<span class="n">fragment_predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">transformers</span><span class="p">)[:,</span> <span class="n">assay_idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>\n<span class="n">contributions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>\n    <span class="s1">\'Change in predicted toxicity\'</span><span class="p">:</span> \n    <span class="p">(</span><span class="n">full_molecule_prediction</span> <span class="o">-</span> <span class="n">fragment_predictions</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>\n<span class="p">})</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <p>\n      We can use the InteractiveMolecule widget from TCW to superimpose the contribution scores on the molecule itself, allowing us to easily asses the relative importance of each atom to the final prediction. If you click on one of the atoms, you can retrieve the contribution data in a card shown to the right of the structure. In this panel you can also select a variable by which to color the atoms in the plot.\n     </p>\n     <p>\n      <img alt="InteractiveMolecule example" src="./assets/trident_chemwidgets_data/InteractiveMolecule.png" width="1000"/>\n     </p>\n     <p>\n      You can generate the interactive widget by running the cell below.\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-CodeCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n     In\xa0[19]:\n    </div>\n    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">\n     <div class="cm-editor cm-s-jupyter">\n      <div class="highlight hl-ipython3">\n       <pre class="overflow-x-scroll"><span></span><span class="n">tcw</span><span class="o">.</span><span class="n">InteractiveMolecule</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">contributions</span><span class="p">)</span>\n</pre>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <div class="jp-Cell-outputWrapper">\n   <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">\n   </div>\n   <div class="jp-OutputArea jp-Cell-outputArea">\n    <div class="jp-OutputArea-child">\n     <div class="jp-OutputPrompt jp-OutputArea-prompt">\n     </div>\n     <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">\n      <pre class="overflow-x-scroll">InteractiveMolecule(data=[{\'Change in predicted toxicity\': 0.5529999732971191}, {\'Change in predicted toxicity…</pre>\n     </div>\n    </div>\n   </div>\n  </div>\n </div>\n <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">\n  <div class="jp-Cell-inputWrapper" tabindex="0">\n   <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">\n   </div>\n   <div class="jp-InputArea jp-Cell-inputArea">\n    <div class="jp-InputPrompt jp-InputArea-prompt">\n    </div>\n    <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">\n     <h1>\n      Wrapping up\n      <a class="anchor-link" href="#Wrapping-up">\n       \xb6\n      </a>\n     </h1>\n     <p>\n      In this tutorial, we learned how to incorporate Trident Chemwidgets into your DeepChem-based ML workflow. While TCW was built with molecular ML workflows in mind, the library also works well for general cheminformatics notebooks as well.\n     </p>\n     <h2>\n      Star Trident Chemwidgets on\n      <a href="https://github.com/tridentbio/trident-chemwidgets">\n       GitHub\n      </a>\n      <a class="anchor-link" href="#Star-Trident-Chemwidgets-on-GitHub">\n       \xb6\n      </a>\n     </h2>\n     <p>\n      If you find the Trident Chemwidgets package helpful please give it a ⭐️ on GitHub. Starring the project helps it grow and find new audiences.\n     </p>\n     <h1>\n      Congratulations! Time to join the Community!\n      <a class="anchor-link" href="#Congratulations!-Time-to-join-the-Community!">\n       \xb6\n      </a>\n     </h1>\n     <p>\n      Congratulations on completing this tutorial notebook! If you enjoyed working through the tutorial, and want to continue working with DeepChem, we encourage you to finish the rest of the tutorials in this series. You can also help the DeepChem community in the following ways:\n     </p>\n     <h2>\n      Star DeepChem on\n      <a href="https://github.com/deepchem/deepchem">\n       GitHub\n      </a>\n      <a class="anchor-link" href="#Star-DeepChem-on-GitHub">\n       \xb6\n      </a>\n     </h2>\n     <p>\n      This helps build awareness of the DeepChem project and the tools for open source drug discovery that we\'re trying to build.\n     </p>\n     <h2>\n      Join the DeepChem Gitter\n      <a class="anchor-link" href="#Join-the-DeepChem-Gitter">\n       \xb6\n      </a>\n     </h2>\n     <p>\n      The DeepChem\n      <a href="https://gitter.im/deepchem/Lobby">\n       Gitter\n      </a>\n      hosts a number of scientists, developers, and enthusiasts interested in deep learning for the life sciences. Join the conversation!\n     </p>\n    </div>\n   </div>\n  </div>\n </div>\n</main>\n'},i=a(7294),o=a(7466),r=a.n(o);let d=()=>((0,i.useEffect)(()=>{var n,s;null===(n=document.getElementsByClassName("scroll-nav")[0])||void 0===n||n.remove();let a=document.querySelector(".notebook"),p=document.querySelector(".notebook");p&&a&&r().init(a,{sections:"h1, h2",insertTarget:p,insertLocation:"after"}),null==MathJax||null===(s=MathJax.Hub)||void 0===s||s.Queue(["Typeset",MathJax.Hub])},[]),(0,p.jsx)("div",{className:"overflow-x-scroll",dangerouslySetInnerHTML:{__html:"".concat(l.html," ").concat(t.Z)}}));d.Layout=e.Z;var c=d}},function(n){n.O(0,[2443,9774,2888,179],function(){return n(n.s=8094)}),_N_E=n.O()}]);